# meta 样例：https://wiki.metacubex.one/
# meta 模板：https://github.com/MetaCubeX/Clash.Meta/blob/Alpha/docs/config.yaml

# 2023.11.20
# 注意:去掉前面的注释符号 "#" 该行生效

#💡 通用设置
# 运行模式：rule 规则、global 全局、direct 直连、script 脚本
mode: rule

# 日志模式：silent 静默、info 信息、warning 警告、error 错误、debug 调试
log-level: info

# ipv6开关 true/false，关闭将阻断所有 ipv6 链接和屏蔽 dns 请求 AAAA 记录
ipv6: true

# 本地 http(s) 服务端口
port: 7890

# 本地 socks5 服务端口
socks-port: 7891

# 本地 http(s) 或 socks5 服务使用同一混合端口
mixed-port: 7890

# linux 和 macos 的透明代理服务器端口
redir-port: 7892

# linux 的透明代理服务器端口( tcp、udp )
tproxy-port: 7893

# 为 linux 下的出站连接提供默认流量标记
routing-mark: 6666

# 本地 http(s)、socks 服务端口验证的用户名和密码
#authentication: 
#  - "clash:88888888"

# 本地 http(s)、socks 服务端口跳过验证的ip段
#skip-auth-prefixes: 
#  - "127.0.0.0/8"
#  - "::1/128"
  
# 允许局域网内其它设备通过 clash 访问互联网开关 true/false
allow-lan: true

# 仅适用 allow-lan 为 true 的情况，绑定 ip 仅允许某个 ip 访问代理端口
# 支持三种参数："*" 绑定所有ip地址，192.168.188.188 绑定一个的 ipv4 地址，[aaaa::a8aa:ff:fe09:57d8] 绑定一个 ipv6 地址
bind-address: "*"

# 指定 clash 出口网卡名称
# interface-name: en0

# 如果域名解析结果对应多个 ip,并发所有 ip 选择握手最快的 ip 进行连接「meta专属」
tcp-concurrent: true

# 控制 clash 发出tcp keep alive包的间隔，减少移动设备耗电问题的临时措施
keep-alive-interval: 30

# 更换延迟计算方式,去除握手等额外延迟开关 true/false
unified-delay: true

# 全局客户端 tls 指纹,可选 chrome/firefox/safari/ios/android/edge/360/qq/random
global-client-fingerprint: chrome

# 自定义外部资源下载时使用的的 ua,默认为 clash.meta
global-ua: Chrome/119.0.6045.106

# 禁用 quic-go-gso 支持开关 true/false，这可能会导致 linux 上的性能降低
experimental:
  quic-go-disable-gso: false
  
# api 监听地址，你可以将 127.0.0.1 修改为 0.0.0.0 来监听所有 IP
external-controller: 127.0.0.1:9090

# https-api 监听地址，需要配置tls部分证书和其私钥配置，使用tls也必须填写external-controller
external-controller-tls: 127.0.0.1:9443

# http(s)-api、api 监听地址外部控制器访问密钥
secret: "88888888"

# 配置外部控制器 web ui 目录，存放配置文件的相对路径，或存放网页静态资源的绝对路径
# clash core将会将其部署在 http://{{external-controller}}/ui
#external-ui: /ui/folder

# 自定义外部用户界面名字
#external-ui-name: xd

# 自定义外部用户界面下载地址
#external-ui-url: "https://gh-proxy.com/https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"

# 目前仅用于 api 的 https
#tls:
#  certificate: string # 证书 PEM 格式，或者 证书的路径
#  private-key: string # 证书对应的私钥 PEM 格式，或者私钥路径
#  custom-certifactes:
#    - |
#      -----BEGIN CERTIFICATE-----
#      format/pem...
#      -----END CERTIFICATE-----

# 查找进程模式有 3 个值
# - always, 开启，强制匹配所有进程
# - strict, 默认，由 clash 判断是否开启
# - off, 不匹配进程，推荐在路由器上使用此模式
find-process-mode: strict

# geoip.dat 数据库开关 true/false，false 使用 mmdb 数据库「meta专属」
geodata-mode: true

# geo 文件加载模式
# standard：标准加载器
# memconservative：专为内存受限(小内存)设备优化的加载器(默认值)
geodata-loader: memconservative

# 自定义 geoip.data url
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geoip.dat"
  geosite: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat"
  mmdb: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/Country.mmdb"
  
# profile 为扩展配置，但在 Clash.meta, 仅作为缓存项使用
profile:
# 储存 api 对策略组的选择，以供下次启动时使用
  store-selected: true
# 储存fakeip映射表，域名再次发生连接时，使用原有映射地址
  store-fake-ip: true

#💡 ssid 策略  
strategy:
  OpenWrt, OpenWrt_5G: 
    tun: false
    mixin: false
    system: true
  
#💡 tun 模式配置
tun:
# tun 模式开关 true/false
  enable: false
# 网络栈类型 system/gvisor
  stack: system
# 自动重定向开关 true/false
  auto-redir: true
# 配置路由表  
  auto-route: false
# 启用 auto_route 时使用自定义路由而不是默认路由  
  inet4_route_address:
    - 0.0.0.0/1
    - 128.0.0.0/1
  inet6_route_address:
    - "::/1"
    - "8000::/1"  
# 自动识别出口网卡
  auto-detect-interface: true
# 将所有连接路由到 tun 来防止泄漏，但你的设备将无法其他设备被访问
  strict_route: true
# dns 劫持仅支持 tcp/udp
  dns-hijack:
    - any:53

#💡 dns 服务器配置
dns:
# dns 开关 true/false，关闭将使用系统 dns
  enable: true
# ipv6 解析开关 true/false；如果为 false，将返回 ipv6 结果为空
  ipv6: true
# 内部双栈并发时，向上游查询时的等待时间，默认 100ms (单位：ms)
  ipv6-timeout: 300
 # doh 支持 http/3 开关 true/false
  prefer-h3: true
# 需要劫持的 dns
  listen: 0.0.0.0:53
# 是否查询系统 hosts 配置开关 true/false
  use-hosts: true
# 搜索域以获取 a/aaaa 记录
  search-domains: [local]
# dns 增强模式  
  enhanced-mode: fake-ip
# fake-ip 解析地址池  
  fake-ip-range: 198.18.0.1/16
# fake-ip 过滤，列表中的域名返回真实 ip
  fake-ip-filter:
    - "*.lan"
    - "*.local"
    - "localhost"
    - "WORKGROUP"
    - "*.msftncsi.com"
    - "*.msftconnecttest.com"
    - "cable.auth.com"
    - "captive.apple.com"
    - "*.cmpassport.com"
    - "id6.me"
    - "open.e.189.cn"
    - "auth.wosms.cn"
    - "mdn.open.wo.cn"
    - "opencloud.wostore.cn"
    - "localhost.*.qq.com"
    - "localhost.*.weixin.qq.com"
    
# 引导解析其他 dns 服务器,只支持纯 ip 可使用加密 dns
  default-nameserver:
    - "223.5.5.5"
    - "119.29.29.29"
    - "tls://1.0.0.1:853"
    
# 默认 dns 服务器，支持 udp/tcp/dot/doh/doq 等协议   
  nameserver:
    - "https://dns.alidns.com/dns-query" # 指定 doq 服务器查询
    - "https://doh.pub/dns-query" # 指定 doh 服务器查询
    #- "tls://dns.alidns.com" # 指定 dot 服务器查询
    #- "tls://dot.pub:853" # 指定 dot 服务器查询
    - "quic://dns.alidns.com:853" # 指定 doq 服务器查询，不支持 premium 内核
    #- "https://223.5.5.5/dns-query#en0" # 指定dns出口网卡
    #- "https://223.6.6.6/dns-query#h3=true" # 指定 doq 服务器查询，强制 http/3
# 回落 dns 服务器，解析代理服务器节点域名，查询失败将使用 nameserver，非并发查询
  proxy-server-nameserver:
    - "8.8.8.8"
    - "1.0.0.1"
    - "208.67.222.222"
    
# 当开启 fallback 时，会查询 geoip 过滤不是 cn 时用以下 dns 解析
  fallback:
    - "tls://dns.google" # 指定 dot 服务器查询
    - "https://1.0.0.1/dns-query" # 指定 doh 服务器查询
    - "https://doh.opendns.com/dns-query" # 指定 doh 服务器查询
    #- "https://dns.google/dns-query#proxy" # dns 经过代理查询
    #- "https://cloudflare-dns.com/dns-query#proxy&h3=true" # dns 经过代理查询，强制 http/3，此选项与 perfer-h3 不冲突
    
# 配置 fallback 使用条件，回落 dns 服务器过滤
  fallback-filter:
# 配置 geoip开关 true/false
    geoip: true
# geoip 匹配区域设定，查询不是 cn 时使用 fallback 返回结果
    geoip-code: CN
# 配置强制 fallback，优先于 ip 判断，具体分类自行查看 geosite 库
    geosite:
      - gfw
# 如果不匹配 ipcidr 则使用 nameservers 中的结果    
    ipcidr:
      - 240.0.0.0/4      
# 指定该域名用 fallback 解析   
    domain:
      - "+.google.com"
      - "+.facebook.com"
      - "+.youtube.com"
    
# 使用指定的 dns 服务器解析域名
nameserver-policy:
  nameserver-policy:
    "openwrt.lan": system
    "openwrt.org": tls://dns.alidns.com
    "blog.google": tls://dot.pub
    "dns.alidns.com": 223.5.5.5
    "doh.pub": 1.12.12.12
    "talk.google.com": 108.177.125.188
    "mtalk.google.com": 108.177.125.188
    "dl.google.com": https://doh.pub/dns-query
    "dl.l.google.com": https://dns.alidns.com/dns-query
    "update.googleapis.com": quic://dns.alidns.com:853
        
#💡 本地域名映射
hosts:
  "*.clash.dev": 127.0.0.1
  ".dev": 127.0.0.1
  "alpha.clash.dev": "::1"
  
#💡 自定义系统代理需要绕过的域名或 ip
bypass:
  - localhost
  - local.adguard.org
  - injections.adguard.org
  - 127.*
  - 10.*
  - 172.16.*
  - 172.17.*
  - 172.18.*
  - 172.19.*
  - 172.20.*
  - 172.21.*
  - 172.22.*
  - 172.23.*
  - 172.24.*
  - 172.25.*
  - 172.26.*
  - 172.27.*
  - 172.28.*
  - 172.29.*
  - 172.30.*
  - 172.31.*
  - 192.168.*
  - <local>
  - ...

#💡 sniffer 域名嗅探器通过读取握手包内的域名字段，将 ip 还原成域名，有效解决 mapping 机制的短板
sniffer:
# 配置 sniffer 开关 true/false
  enable: true
# 对所有未获取到域名的流量进行强制嗅探
  parse-pure-ip: true
# 对redir-host类型识别的流量进行强制嗅探
  force-dns-mapping: true
# 是否使用嗅探结果作为实际访问，默认为 true  
  override-destination: true
# 需要嗅探的协议类型  
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
# 需要跳过嗅探的域名。主要解决部分站点 sni 字段非域名，导致嗅探结果异常的问题，如米家设备   
  skip-domain:
    - 'Mijia Cloud'
    - 'dlg.io.mi.com'
    - '+.apple.com'
# 需要强制嗅探的域名（默认情况下只对 IP 进行嗅探）   
  force-domain:
    - 'google.com'
# 端口白名单
  port-whitelist:
    - 80
    - 443
    - 8000-9000

#💡 流量入站配置,可以作为服务器
listeners: 
# 用于监听局域网流量的入站,适用于无加密传输
  - name: socks5-lan 
    # socks代理
    type: socks
    port: 10808
    # 默认监听 0.0.0.0
    listen: 0.0.0.0
    # 默认使用 rules,如果未找到 sub-rule 则直接使用 rules
    rule: rules
    # 如果不为空则直接将该入站流量交由指定 proxy 处理
    proxy: ☁️ WARP+Teams
    # 默认 true
    udp: true

# 用于监听局域网流量的入站,适用于无加密传输
  - name: http-lan
    # htpp(s)代理
    type: http
    port: 10809
    listen: 0.0.0.0
    # 默认使用 rules,如果未找到 sub-rule 则直接使用 rules
    rule: rules
    # 如果不为空则直接将该入站流量交由指定 proxy 处理(当 proxy 不为空时,这里的 proxy 名称必须合法,否则会出错)
    proxy: ☁️ WARP+Teams
    # 默认 true
    udp: true

# 用于监听局域网流量的入站,适用于无加密传输
  - name: mixed-lan
    # htpp(s) 和 socks 代理混合
    type: mixed
    port: 10810
    listen: 0.0.0.0
    # 默认使用 rules,如果未找到 sub-rule 则直接使用 rules
    rule: rules
    # 如果不为空则直接将该入站流量交由指定 proxy 处理(当 proxy 不为空时,这里的 proxy 名称必须合法,否则会出错)
    proxy: ☁️ WARP+Teams
    # 默认 true
    udp: true

# 互联网用于加密传输流量的入站
  - name: shadowsocks-wwan
    type: shadowsocks
    port: 10813
    listen: 0.0.0.0
    # 默认使用 rules,如果未找到 sub-rule 则直接使用 rules
    rule: rules
    # 如果不为空则直接将该入站流量交由指定 proxy 处理(当 prox y不为空时,这里的 proxy 名称必须合法,否则会出错)
    proxy: ☁️ WARP+
    password: wEPBA9NACxZ+lfcTD0yFDrx83RNWseNw2O3yJYWeVmk=
    cipher: aes-256-gcm

# 互联网用于加密传输流量的入站
  - name: vmess-wwan
    type: vmess
    port: 10814
    listen: 0.0.0.0
    # 默认使用 rules,如果未找到 sub-rule 则直接使用 rules
    rule: rules
    # 如果不为空则直接将该入站流量交由指定 proxy 处理(当 proxy 不为空时,这里的 proxy 名称必须合法,否则会出错)
    proxy: ☁️ WARP+
    users:
      - username: WARP+
        uuid: 08c4ff67-599a-4d28-90a5-9d85fecd0e5b
        alterId: 1

#💡 隧道模式，代理转发到目标服务器
tunnels:
  # 一行简约配置
  - tcp,127.0.0.1:6553,223.5.5.5:53,✅ Node
  - tcp/udp,127.0.0.1:6666,doh.pub:443,✅ Node
  # 完整 yaml 配置
  - network: 
      - tcp
      - udp  
    address: 127.0.0.1:7777
    target: dns.alidns.com:443
    proxy: ✅ Node
  
#💡 本地代理服务器
proxies:
  - name: ☁️ WARP+ # 代理名称,书写时请确保不会与其他代理节点重名
    type: wireguard # 代理类型,此处为 wireguard
    server: 188.114.97.59 # wireguard 服务端地址
    port: 1180 # wireguard 服务端端口
    ip: 172.16.0.2 # 本机在 Wireguard 网络中使用的 IPv4 地址
    ipv6: 2606:4700:110:89db:66c6:5265:3a6f:b92 # 可选字段，本机在 wireguard 网络中使用的 IPv6 地址
    private-key: wEPBA9NACxZ+lfcTD0yFDrx83RNWseNw2O3yJYWeVmk= # base64 编码的 wireguard 客户端私钥
    public-key: bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo= #　base64 编码的 wireguard 服务端公钥
    #preshared-key: 66l8JUDdpHBBSKezlDVwNKyaNaEm+xZ+3/1 # 可选字段，预共享密钥
    remote-dns-resolve: true # 可选字段，是否强制 dns 远程解析，默认值为 false
    dns: [1.1.1.1,2606:4700:4700::1111] # 可选字段，当 remote-dns-resolve 为 true 时生效，指定远程解析使用的 dns 服务器
    persistent-keepalive: 45 # 可选字段，数据包间隔持久保活时长
    reserved: [173,82,247] # 可选字段，Wireguard 协议保留字段的值，部分 warp 节点需要使用
    allowed-ips: ["0.0.0.0/0"] # 可选字段，限制客户端的哪些 IP 段的流量由服务端进行转发。一般情况下可填 ['0.0.0.0/0']
    mtu: 1280 # 可选字段，设置 mtu 值
    udp: true # 可选字段，是否启用 UDP 支持
    dialer-proxy: 🇭🇰 HongKong # 一个出站代理的标识。当值不为空时，将使用指定的 proxy/proxy-group 发出连接,用于 Wireguard 配置链式代理
    peers: # 如果使用多个 peer，每一个 peer 的 allowed-ips 需要做区分；此时顶层段落的 server, port, ip, ipv6, public-key, pre-shared-key, reserved 等字段均会被忽略，不过 private-key 仍然在顶层指定
     - server: engage.nanocat.me
       port: 2408
       ip: 172.16.0.2
       ipv6: 2606:4700:110:89db:66c6:5265:3a6f:b92
       public-key: bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=
       #pre-shared-key: 31aIhAPwktDGpH4JDhA8GNvjFXEf/a6+UaQRyOAiyfM=
       allowed_ips: ["0.0.0.0/0","::/0"]
       reserved: [173,82,247]
       
  - name: ☁️ WARP+Teams
    type: wireguard
    server: 188.114.97.229
    port: 2506
    ip: 172.16.0.2
    ipv6: 2606:4700:110:8f21:225d:3e30:7660:78cf
    private-key: QOmt5UE2jp5s2vqYMKmjd714tBC7eteELAFRCEinJG4=
    public-key: bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=
   # preshared-key: 66l8JUDdpHBBSKezlDVwNKyaNaEm+xZ+3/1
    remote-dns-resolve: true
    dns: [1.0.0.1,2606:4700:4700::1001]
    persistent-keepalive: 45
    reserved: [80,73,10]
    allowed-ips: ["0.0.0.0/0"]
    mtu: 1280
    udp: true
    dialer-proxy: 🇹🇼 Taiwan
    peers:
     - server: engage.nanocat.cloud
       port: 2408
       ip: 172.16.0.2
       ipv6: 2606:4700:110:8f21:225d:3e30:7660:78cf
       public-key: bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=
       # pre-shared-key: 31aIhAPwktDGpH4JDhA8GNvjFXEf/a6+UaQRyOAiyfM=
       allowed_ips: ["0.0.0.0/0","::/0"]
       reserved: [80,73,10]

#💡 远程代理服务器订阅链接
proxy-providers:
  ALL:
    type: http
    path: /proxy/all.yaml
    url: https://sub.xeton.dev/sub?target=clash&url=订阅链接|订阅链接&list=true&emoji=true&sort=true&udp=true&tfo=true&scv=true&append_type=true&fdn=true&new_name=true
    interval: 86400
    udp: true
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

# 服务器节点筛选
  HK:
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇭🇰|港|香港|hk|HK|Hong|HongKong
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600
      
  TW: 
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇹🇼|台|台湾|台北|臺灣|tw|TW|Tai|Taiwan
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600
      
  JP:
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇯🇵|日|日本|川日|东京|大阪|泉日|埼玉|沪日|深日|jp|JP|Japan
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600
      
  KR:
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇰🇷|韩|韓|韩国|韓國|首尔|朝鲜|kr|KR|KOR|Korea|South Korea|SouthKorea
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600
      
  SG:
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇸🇬|新|狮|新加坡|狮城|sg|SG|Singapore
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

  US:
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇺🇸|美|美国|美國|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|us|US|United States|UnitedStates|America
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

  UN:
    type: file
    path: /proxy/all.yaml
    filter: ^((?!🇨🇳|中国|大陆|国内|回国|cn|CN|CHINA|电信|移动|联通|腾讯|阿里|教育|校园|直连|🇭🇰|港|香港|hk|HK|Hong|HongKong|🇹🇼|台|台湾|台北|臺灣|tw|TW|Tai|Taiwan|🇯🇵|日|日本|川日|东京|大阪|泉日|埼玉|沪日|深日|jp|JP|Japan|🇰🇷|韩|韓|韩国|韓國|首尔|朝鲜|kr|KR|KOR|Korea|South Korea|SouthKorea|🇸🇬|新|狮|新加坡|狮城|sg|SG|Singapore|🇺🇸|美|美国|美國|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|us|US|United States|UnitedStates|America).)*$
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

  CN:
    type: file
    path: /proxy/all.yaml
    filter: (?i)🇨🇳|中国|大陆|国内|回国|cn|CN|CHINA|电信|移动|联通|腾讯|阿里|教育|校园|直连
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

#💡 策略组
proxy-groups:
  - name: 🔰 Pick
    type: select
    proxies:
      - ♻️ Auto
      - ✅ Node
      - ⚖️ Load Balance
      - ⚙️ Fallback
      - 🛞 Proxy Chain
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations
      - 🇨🇳 Chinese
      - ☁️ WARP+
      - ☁️ WARP+Teams
      - DIRECT
      - REJECT

# 将按照url测试结果使用延迟最低节点
  - name: ♻️ Auto
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - ALL
    proxies:
      - ☁️ WARP+
      - ☁️ WARP+Teams
      
# 用户自行选择策略组或节点
  - name: ✅ Node
    type: select
    use:
      - ALL 
    proxies:
      - ☁️ WARP+
      - ☁️ WARP+Teams
      
# 将按照算法随机选择节点,不同的请求使用不同的代理
  - name: ⚖️ Load Balance
    type: load-balance
    url: http://www.gstatic.com/generate_204
    interval: 600
    lazy: true
    # 禁用该组 udp 流量转发   
    #disable-udp: true
    # consistent-hashing 同一请求采用相同代理
    # round-robin 所有请求使用不同的代理   
    strategy: consistent-hashing
    proxies:
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

# 将按url测试结果按照节点顺序选择,直到该策略超时，才选择下一个可用代理
  - name: ⚙️ Fallback
    type: fallback
    url: http://www.gstatic.com/generate_204
    interval: 600
    lazy: true
    # 禁用该组 udp 流量转发    
    #disable-udp: true
    proxies:
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations
      
# 代理链，目前 relay 可以支持 udp 的只有 vmess/vless/trojan/ss/ssr/tuic
# wireguard 目前不支持在 relay 中使用，请使用 proxy 中的 dialer-proxy 配置项
# Traffic: clash <-> http <-> vmess <-> ss1 <-> ss2 <-> Internet
  - name: 🛞 Proxy Chain
    type: relay
    url: http://www.gstatic.com/generate_204
    interval: 600
    proxies:
      - 🇭🇰 HongKong
      - ☁️ WARP+Teams

  - name: 🇭🇰 HongKong
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - HK
    
  - name: 🇹🇼 Taiwan
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - TW

  - name: 🇯🇵 Japan
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - JP    
      
  - name: 🇰🇷 Korea
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - KR

  - name: 🇸🇬 Singapore
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - SG
      
  - name: 🇺🇸 America
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - US

  - name: 🇺🇳 Nations
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - UN

  - name: 🇨🇳 Chinese
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 600
    tolerance: 0
    lazy: true
    use:
      - CN

  - name: 🕸️ Speedtest
    type: select
    proxies:
      - 🇨🇳 China
      - 🔰 Pick
      
  - name: 🎵 TikTok
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: ✉️ Telegram
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🗣️ Discord
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🎶 Spotify
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 📽️ Netflix
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 📼 Disney+
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 📹 YouTube
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations
      
  - name: 🤖 OpenAI
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🛒 Amazon
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🎭 Facebook
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 📟 Google
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America      
      - 🇺🇳 Nations

  - name: 🖥️ Microsoft
    type: select
    proxies:
      - 🇨🇳 China
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🍎 Apple
    type: select
    proxies:
      - 🇨🇳 China
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🎬 Global Media
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 🌐 Global
    type: select
    proxies:
      - 🔰 Pick
      - 🇭🇰 HongKong
      - 🇹🇼 Taiwan
      - 🇯🇵 Japan
      - 🇰🇷 Korea
      - 🇸🇬 Singapore
      - 🇺🇸 America
      - 🇺🇳 Nations

  - name: 📺 China Media
    type: select
    proxies:
      - 🇨🇳 China
      - 🔰 Pick

  - name: 🇨🇳 China
    type: select
    proxies:
      - DIRECT
      - 🔰 Pick
      - ✅ Node
      - 🇨🇳 Chinese
      - ⛔ AdBlock

  - name: 🐟 Final
    type: select
    proxies:
      - 🔰 Pick
      - 🇨🇳 China
      - ⛔ AdBlock

  - name: ⛔ AdBlock
    type: select
    proxies:
      - REJECT
      - DIRECT

#💡 远程分流规则
rule-providers:
  🚥 Direct:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Direct/Direct.yaml
    path: /rule/Direct.yaml
    interval: 86400

  ⛔ Anti.ad:
    type: http
    behavior: domain
    url: https://anti-ad.net/clash.yaml
    path: /rule/anti-ad.yaml
    interval: 86400

  ⛔ Privacy:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Privacy/Privacy_Classical.yaml
    path: /rule/Privacy_Classical.yaml
    interval: 86400
    
  ⛔ Hijacking:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Hijacking/Hijacking.yaml
    path: /rule/Hijacking.yaml
    interval: 86400
    
  ⛔ AdvertisingLite:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingLite/AdvertisingLite_Classical.yaml
    path: /rule/AdvertisingLite_Classical.yaml
    interval: 86400

  ⛔ BlockHttpDNS:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BlockHttpDNS/BlockHttpDNS.yaml
    path: /rule/BlockHttpDNS.yaml
    interval: 86400

  🕸️ Speedtest:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Speedtest/Speedtest.yaml
    path: /rule/Speedtest.yaml
    interval: 86400
    
  🎵 TikTok:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.yaml
    path: /rule/TikTok.yaml
    interval: 86400
    
  ✉️ Telegram:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
    path: /rule/Telegram.yaml
    interval: 86400

  🗣️ Discord:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Discord/Discord.yaml
    path: /rule/Discord.yaml
    interval: 86400
    
  🎶 Spotify:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.yaml
    path: /rule/Spotify.yaml
    interval: 86400
    
  📽️ Netflix:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml
    path: /rule/Netflix.yaml
    interval: 86400
    
  📼 Disney+:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.yaml
    path: /rule/Disney.yaml
    interval: 86400
    
  📹 YouTube:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
    path: /rule/YouTube.yaml
    interval: 86400
    
  🤖 OpenAI:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml
    path: /rule/OpenAI.yaml
    interval: 86400

  🛒 Amazon:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Amazon/Amazon.yaml
    path: /rule/Amazon.yaml
    interval: 86400

  🎭 Facebook:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Facebook/Facebook.yaml
    path: /rule/Facebook.yaml
    interval: 86400

  📟 Google:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml
    path: /rule/Google.yaml
    interval: 86400
    
  🖥️ Microsoft:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml
    path: /rule/Microsoft.yaml
    interval: 86400
    
  🍎 Apple.ota:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/SystemOTA/SystemOTA.yaml
    path: /rule/SystemOTA.yaml
    interval: 86400
    
  🍎 Apple:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical.yaml
    path: /rule/Apple_Classical.yaml
    interval: 86400

  🎬 Global Media:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia_Classical.yaml
    path: /rule/GlobalMedia_Classical.yaml
    interval: 86400
    
  🌐 Global:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global_Classical.yaml
    path: /rule/Global_Classical.yaml
    interval: 86400
    
  📺 China Media:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMedia/ChinaMedia.yaml
    path: /rule/ChinaMedia.yaml
    interval: 86400
    
  🇨🇳 China:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China_Classical.yaml
    path: /rule/China_Classical.yaml
    interval: 86400
    
  🇨🇳 China.ips:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaIPs/ChinaIPs_Classical.yaml
    path: /rule/ChinaIPs_Classical.yaml
    interval: 86400

  🇨🇳 China.ipsbgp:
    type: http
    behavior: classical
    url: https://gh-proxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaIPsBGP/ChinaIPsBGP_Classical.yaml
    path: /rule/ChinaIPsBGP_Classical.yaml
    interval: 86400

#💡 规则类型引用（指定规则类型引用代理或策略组）
# DOMAIN 完整域名匹配
# DOMAIN-SUFFIX 域名后缀匹配
# DOMAIN-KEYWORD 域名关键词匹配
# DST-PORT 从目标端口指定规则
# SRC-PORT 发送至端口指定规则
# IP-CIDR 本地 ipv4 规则
# IP-CIDR6 本地 ipv6 规则
# SRC-IP-CIDR 根据数据包的源 ipv4 地址
# PROCESS-NAME 根据进程名称
# PROCESS-PATH 根据进程路径
# GEOIP 根据 geoip 地址国家/地区
# MATCH 不在规则中的请求
# no-resolve 可选，它用于跳过规则的 dns 解析
rules:
  - DOMAIN,ad.cyapi.cn,⛔ AdBlock
  - DOMAIN,ad.21cn.com,⛔ AdBlock
  - DOMAIN,ad.k.21cn.com,⛔ AdBlock
  - DOMAIN,admarket.21cn.com,⛔ AdBlock
  - DOMAIN,adshows.21cn.com,⛔ AdBlock
  - DOMAIN,mssdk-bu.bytedance.com,⛔ AdBlock
  - DOMAIN-SUFFIX,adx.appicad.net,⛔ AdBlock
  - DOMAIN-SUFFIX,m1.ad.10010.com,⛔ AdBlock
  - DOMAIN-KEYWORD,reddit,🌐 Global
  - DOMAIN-KEYWORD,snapchat,🌐 Global
  - PROCESS-NAME,AdGuard.exe,🌐 Global
  - PROCESS-NAME,AdGuardSvc.exe,🌐 Global
  - PROCESS-NAME,pinterest.exe,🌐 Global
  - PROCESS-PATH,C:\Program Files\Microsoft OneDrive\OneDrive.exe,🌐 Global
  - IP-CIDR,10.0.0.0/8,DIRECT,no-resolve
  - IP-CIDR,100.64.0.0/10,DIRECT,no-resolve
  - IP-CIDR,127.0.0.0/8,DIRECT,no-resolve
  - IP-CIDR,172.16.0.0/12,DIRECT,no-resolve
  - IP-CIDR,192.168.0.0/16,DIRECT,no-resolve
  - IP-CIDR,224.0.0.0/24,DIRECT,no-resolve
  - IP-CIDR,169.254.0.0/16,DIRECT,no-resolve
  - IP-CIDR6,2620:0:2d0:200::7/32,DIRECT,no-resolve
  - SRC-IP-CIDR,239.255.255.250/32,DIRECT
  - DST-PORT,1400,✉️ Telegram    
  #- SRC-PORT,7777,DIRECT
  - RULE-SET,🚥 Direct,🇨🇳 China
  - RULE-SET,⛔ Anti.ad,⛔ AdBlock
  - RULE-SET,⛔ Privacy,⛔ AdBlock
  - RULE-SET,⛔ Hijacking,⛔ AdBlock
  - RULE-SET,⛔ AdvertisingLite,⛔ AdBlock
  - RULE-SET,⛔ BlockHttpDNS,⛔ AdBlock
  - RULE-SET,🕸️ Speedtest,🕸️ Speedtest
  - RULE-SET,🎵 TikTok,🎵 TikTok
  - RULE-SET,✉️ Telegram,✉️ Telegram
  - RULE-SET,🗣️ Discord,🗣️ Discord
  - RULE-SET,🎶 Spotify,🎶 Spotify
  - RULE-SET,📽️ Netflix,📽️ Netflix
  - RULE-SET,📼 Disney+,📼 Disney+
  - RULE-SET,📹 YouTube,📹 YouTube
  - RULE-SET,🤖 OpenAI,🤖 OpenAI
  - RULE-SET,🛒 Amazon,🛒 Amazon
  - RULE-SET,🎭 Facebook,🎭 Facebook
  - RULE-SET,📟 Google,📟 Google
  - RULE-SET,🖥️ Microsoft,🖥️ Microsoft
  - RULE-SET,🍎 Apple.ota,⛔ AdBlock
  - RULE-SET,🍎 Apple,🍎 Apple
  - RULE-SET,🎬 Global Media,🎬 Global Media
  - RULE-SET,🌐 Global,🌐 Global
  - RULE-SET,📺 China Media,📺 China Media
  - RULE-SET,🇨🇳 China,🇨🇳 China
  - RULE-SET,🇨🇳 China.ips,🇨🇳 China
  - RULE-SET,🇨🇳 China.ipsbgp,🇨🇳 China
  - GEOIP,CN,🇨🇳 China
  - MATCH,🐟 Final
